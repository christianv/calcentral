<div class="medium-12 columns cc-settings">
  <h1 class="cc-heading-page-title">Settings for {{api.user.profile.fullName}}</h1>

  <section data-ng-if='connectedServices.length' class="cc-settings-section row collapse">
    <div class="medium-10 medium-centered columns">

      <h2>Connected Services</h2>
      <div data-ng-repeat="service in connectedServices">
        <div class="row collapse cc-settings-service-row" data-ng-init="loopname='connected'" data-ng-include src="'settings_service_loop.html'"></div>
      </div>

    </div>
  </section>

  <section data-ng-if='disConnectedServices.length' class="cc-settings-section row collapse">
    <div class="medium-10 medium-centered columns">

      <h2>Services to Connect</h2>

      <div data-ng-repeat="service in disConnectedServices">
        <div class="row collapse cc-settings-service-row" data-ng-init="loopname='disconnected'" data-ng-include src="'settings_service_loop.html'"></div>
      </div>

    </div>
  </section>

  <a class="cc-settings-dashboard-link" href="/dashboard">&laquo; Take me to my Dashboard</a>

  <div data-ng-show="api.user.profile.isViewer || api.user.profile.actingAsUid" data-ng-controller="StudentLookupController">
    <h2>Admin</h2>
    <h3>View as</h3>
    <form data-ng-submit="admin.actAsUser()">
      <div class="row">
        <div class="small-3 columns">
          <label for="cc-settings-act-as-uid">UID/SID</label>
        </div>
        <div class="small-9 columns">
          <input id="cc-settings-act-as-uid" data-ng-model="admin.actAs.id" data-ng-pattern="api.util.uidPattern" placeholder="Enter UID or SID here" type="number" data-cc-select-on-click-directive />
        </div>
      </div>
      <div class="row">
        <div class="small-9 small-offset-3 columns">
          <button
            class="cc-button cc-button-blue"
            data-ng-disabled="!admin.actAs.id"
            type="submit">Submit</button>
        </div>
      </div>
      <div class="row">
        <div class="small-9 small-offset-3 columns">
          <span data-ng-bind="admin.actAsErrorStatus"></span>
        </div>
      </div>
      <div class="row" data-ng-if="admin.userPool">
        <div class="small-9 small-offset-3 columns">
          <ul data-ng-repeat="user in admin.userPool">
            <li>
              UID: <button class="cc-button-link" data-ng-bind="user.ldap_uid" data-ng-click="admin.actAsUser(user)"></button> (SID: {{user.student_id || "none"}})
            </li>
          </ul>
        </div>
      </div>

      <div class="row cc-settings-recent-uids" data-ng-repeat="block in admin.userBlocks">
        <div class="small-9 small-offset-3 columns" data-ng-if="supportsLocalStorage && block.users.length">
          <h4>{{block.title}} (<button type="button" class="cc-button-link" data-ng-click="block.clearAllUsers()">clear all</button>)</h4>
          <ul>
            <li data-ng-repeat="user in block.users track by $index">
              <span>
              UID: <button type="submit" class="cc-button-link" data-ng-click="admin.updateIDField(user.ldap_uid)" data-ng-bind="user.ldap_uid"></button> (SID: {{user.student_id || "none"}})
              </span>
              <span data-ng-if="block.storeUser">(<button type="button" class="cc-button-link" data-ng-click="block.storeUser(user)">save</button>)</span>
              <span data-ng-if="block.clearUser">(<button type="button" class="cc-button-link" data-ng-click="block.clearUser($index)">delete</button>)</span>
            </li>
          </ul>
        </div>
      </div>

    </form>
    <form data-ng-if="api.user.profile.actingAsUid" data-ng-submit="admin.stopActAs()">
      <button class="cc-button cc-button-blue" type="submit">Stop viewing as</button>
    </form>

    <!-- STUDENT LOOKUP ###################################################################  !-->
    <div class="row">
      <div class="small-9 small-offset-2 columns">
        <div class="medium-4 columns">
            <div class="cc-widget cc-widget-student-lookup">
              <div class="cc-widget-title">
                <h2>Student Lookup</h2>
              </div>
              <div class="cc-widget-padding">
                <!-- Navigation -->
                <div class="cc-clearfix-container">
                  <ul class="cc-button-group cc-even-3" role="tablist">
                    <li data-ng-repeat="selectOption in selectOptions">
                      <button class="cc-button"
                        data-ng-click="switchSelectedOption(selectOption)"
                        data-ng-class="{'cc-button-selected':(currentSelection === selectOption)}"
                        aria-selected="{{currentSelection === selectOption}}"
                        role="tab"
                        data-ng-bind="selectOption">
                      </button>
                    </li>
                  </ul>
                </div>

                <!-- Search Users -->
                <div data-ng-if="currentSelection === 'Search'">
                  <form data-ng-submit="admin.lookupUser()">
                    <div class="row">
                      <label for="cc-widget-student-lookup-search">Enter UID or SID</label>
                      <div>
                        <input id="cc-widget-student-lookup-search"class="cc-left" data-ng-pattern="api.util.uidPattern" data-ng-model="admin.query" type="number" data-cc-select-on-click-directive />
                        <button
                          class="cc-button cc-button-blue cc-widget-student-lookup-search-button"
                          data-ng-disabled="!admin.query"
                        type="submit">Search</button>
                      </div>
                    </div>

                    <div class="row" data-ng-bind="admin.lookupErrorStatus"></div>
                    <div data-ng-if="admin.searchedUsers.length" class="row cc-table">
                        <table>
                          <thead>
                            <tr>
                              <th width="30%" scope="col">SID</th>
                              <th width="60%" scope="col">Name</th>
                            </tr>
                          </thead>
                          <tbody data-ng-repeat="user in admin.searchedUsers">
                            <tr>
                              <td data-ng-bind="user.student_id || 'none'"></td>
                              <td><button type="button" class="cc-button-link" data-ng-bind="admin.titleCaseName(user)" data-ng-click="admin.actAsUser(user)"></button></td>
                              <td><button type="button" class="cc-button-link" data-ng-click="">Star</button></td>
                            </tr>
                          </tbody>
                        </table>
                    </div>
                  </form>

                </div>

                <!-- Saved Users -->
                <div data-ng-if="currentSelection === 'Saved'" class="cc-widget-student-lookup-tab">
                  <div data-ng-if="!admin.storedUsers.saved.length">No saved items yet.</div>
                  <div data-ng-if="admin.storedUsers.saved.length" class="row cc-table">
                    <table>
                      <thead>
                        <tr>
                          <th width="30%" scope="col">SID</th>
                          <th width="60%" scope="col">Name</th>
                        </tr>
                      </thead>
                      <tbody data-ng-repeat="user in admin.storedUsers.saved">
                      <tr>
                        <td data-ng-bind="user.student_id || 'none'"></td>
                        <td><button type="button" class="cc-button-link" data-ng-bind="admin.titleCaseName(user)" data-ng-click="admin.actAsUser(user)"></button></td>
                        <td><button type="button" class="cc-button-link" data-ng-click="">Star</button></td>
                      </tr>
                      </tbody>
                    </table>
                  </div>
                </div>

                <!-- Recent Users -->
                <div data-ng-if="currentSelection === 'Recent'" class="cc-widget-student-lookup-tab">
                  <div data-ng-if="!admin.storedUsers.recent.length">No recent items yet.</div>
                  <div data-ng-if="admin.storedUsers.recent.length" class="row cc-table">
                    <table>
                      <thead>
                        <tr>
                          <th width="30%" scope="col">SID</th>
                          <th width="60%" scope="col">Name</th>
                        </tr>
                      </thead>
                      <tbody data-ng-repeat="user in admin.storedUsers.recent">
                      <tr>
                        <td data-ng-bind="user.student_id || 'none'"></td>
                        <td><button type="button" class="cc-button-link" data-ng-bind="admin.titleCaseName(user)" data-ng-click="admin.actAsUser(user)"></button></td>
                        <td><button type="button" class="cc-button-link" data-ng-click="">Star</button></td>
                      </tr>
                      </tbody>
                    </table>
                  </div>
                </div>

              </div>
            </div>
        </div>
      </div>
    </div>

    <div data-ng-controller="ApiTestController" data-ng-show="apiTest.enabled">
      <h3>Api Test</h3>
      <form class="api-test-form" data-ng-submit="runApiTest()">
        <button class="cc-button cc-button-blue" id="cc-settings-run-api-test-submit" data-ng-disabled="apiTest.running" type="submit">Run test</button>
        <div class="cc-settings-section" data-ng-show="apiTest.showTests">
          <ul class="cc-settings-apitest-list">
            <li data-ng-class="{'cc-settings-apitest-failed': (route.status == 'failed'), 'cc-settings-apitest-success': (route.status == 'success')}"
                data-ng-repeat="route in apiTest.data" data-ng-bind-template="{{route.route}}: {{route.status}}"></li>
          </ul>
        </div>
      </form>
    </div>
  </div>

</div>
